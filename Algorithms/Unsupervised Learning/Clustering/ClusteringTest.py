import scipy.io as io
import numpy as np
from KMeans import KMeans
from utils import plot_resultados, ver_imagen



"""

------------------------------------------------------------------------------------------------------------------------

                                             EJEMPLO CLUSTERING SIMPLE

------------------------------------------------------------------------------------------------------------------------

"""


#-----------------------------------------------------------------------------------------------------------------------
#---------------------------------------------- OBTENCION DATOS --------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------


data = io.loadmat("../../../data/ex7data2.mat")
print("Columnas data: ", data.keys())

X = data['X']


#-----------------------------------------------------------------------------------------------------------------------
#------------------------------------------- INICIALIZACION VARIABLES --------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------

k = 3
print('Numero de centroids:', k)


#-----------------------------------------------------------------------------------------------------------------------
#------------------------------------------- APLICACION ALGORITMO ------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------

kmeans = KMeans(X, k)
lista_centroids = kmeans.fit()


#-----------------------------------------------------------------------------------------------------------------------
#---------------------------------------- VISUALIZACION RESULTADOS -----------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------

plot_resultados(kmeans.X, kmeans.indices, lista_centroids)



"""

------------------------------------------------------------------------------------------------------------------------

                                             EJEMPLO IMAGEN

------------------------------------------------------------------------------------------------------------------------

"""


#-----------------------------------------------------------------------------------------------------------------------
#---------------------------------------------- OBTENCION DATOS --------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------

image_data = io.loadmat("../../../data/bird_small.mat")
print("Columnas datos: ", image_data.keys())

pixeles_imagen = image_data['A']
print('Dimension imagen:', pixeles_imagen.shape)

X = np.array(pixeles_imagen, dtype=float)                                                   # Obligamos a que los datos sean float


#-----------------------------------------------------------------------------------------------------------------------
#------------------------------------------- INICIALIZACION VARIABLES --------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------

k= 16

X /= 255                                                                                    # Hacemos que su valor este en 0 y 1
X = np.reshape(X, (-1, 3))                                                                  # Comprimimos los pixeles en una sola dimension
print('Dimension imagen:', X.shape)


#-----------------------------------------------------------------------------------------------------------------------
#------------------------------------------- APLICACION ALGORITMO ------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------

kmeans = KMeans(X, k)
kmeans.fit()


#-----------------------------------------------------------------------------------------------------------------------
#------------------------------------------- OBTENCION DE IMAGEN -------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------

X_comprimido = kmeans.X
X_comprimido[np.arange(kmeans.indices.shape[0]), :] = kmeans.centroids[kmeans.indices, :]   # Asignamos el color que le corresponde a cada X_comprimido
X_comprimido = np.reshape(X_comprimido, (128, 128, 3))                                      # Descomprimimos los pixeles a su estructura original
X_comprimido*=255                                                                           # Restablecemos su valor entre 0 y 255
X_comprimido = np.array(X_comprimido, dtype=int)                                            # Casteamos a int


#-----------------------------------------------------------------------------------------------------------------------
#---------------------------------------- VISUALIZACION RESULTADOS -----------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------

ver_imagen(pixeles_imagen, X_comprimido)



"""

------------------------------------------------------------------------------------------------------------------------

                                EJEMPLO CLUSTERING SIMPLE NO LOCAL MINIMA

------------------------------------------------------------------------------------------------------------------------

"""


#-----------------------------------------------------------------------------------------------------------------------
#---------------------------------------------- OBTENCION DATOS --------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------


data = io.loadmat("../../../data/ex7data2.mat")
print("Columnas data: ", data.keys())

X = data['X']


#-----------------------------------------------------------------------------------------------------------------------
#------------------------------------------- INICIALIZACION VARIABLES --------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------

k = 3
print('Numero de centroids:', k)


#-----------------------------------------------------------------------------------------------------------------------
#------------------------------------------- APLICACION ALGORITMO ------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------

kmeans = KMeans(X, k)
lista_centroids = kmeans.fit(evitar_local_optima=True)


#-----------------------------------------------------------------------------------------------------------------------
#---------------------------------------- VISUALIZACION RESULTADOS -----------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------

plot_resultados(kmeans.X, kmeans.indices, lista_centroids)


"""

------------------------------------------------------------------------------------------------------------------------

                                EJEMPLO CLUSTERING SIMPLE ELECCION K

------------------------------------------------------------------------------------------------------------------------

"""

kmeans = KMeans(X)
#lista_centroids = kmeans.fit(evitar_local_optima=True)